image: python:latest

stages:
  - prepare
  - install
  - test
  - terraform

check:
  stage: prepare
  script:
    - python -v
    - apt update -y
    - apt upgrade -y
    - apt install curl -y

testfile:
  stage: test
  script:
    - ls -all | egrep "**.py"

terra:
  stage: terraform
  image: hashicorp/terraform
  script:
    - terraform -v
    - terraform apply

awscliinstall:
  image: registry.gitlab.com/gitlab-org/cloud-deploy/aws-base:latest
  stage: install
  script:
    - aws s3 ls
    - ls -all | egrep "**.py"
    - aws s3 cp frontend.html s3://$S3_BUCKET/
